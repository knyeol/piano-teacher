{"ast":null,"code":"import _slicedToArray from \"D:\\\\Code\\\\Projects\\\\piano-teacher\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\Code\\\\Projects\\\\piano-teacher\\\\frontend\\\\src\\\\pages\\\\Blog\\\\Posts.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { GET_POSTS } from \"../../apollo/\";\nimport { useLazyQuery } from \"@apollo/client\";\nimport Card from \"../../components/Card\";\n\nfunction Posts() {\n  var _this = this;\n\n  var increment = 5;\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      posts = _useState2[0],\n      setPosts = _useState2[1];\n\n  var _useLazyQuery = useLazyQuery(GET_POSTS),\n      _useLazyQuery2 = _slicedToArray(_useLazyQuery, 2),\n      getPosts = _useLazyQuery2[0],\n      data = _useLazyQuery2[1].data;\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      scroll = _useState4[0],\n      setScroll = _useState4[1];\n\n  var location = useLocation().pathname;\n\n  function updateScroll() {\n    return document.body.scrollHeight - (window.screen.height + window.scrollY);\n  }\n\n  useEffect(function () {\n    window.addEventListener(\"scroll\", function () {\n      return setScroll(updateScroll());\n    });\n    getPosts({\n      variables: {\n        limit: increment\n      }\n    });\n  }, []);\n  useEffect(function () {\n    if (!data || scroll > 0) return;\n    getPosts({\n      variables: {\n        limit: data.posts.length + increment\n      }\n    });\n    setScroll(updateScroll());\n    setPosts(data.posts);\n  }, [data, scroll]);\n  return /*#__PURE__*/React.createElement(\"section\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"section-title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 7\n    }\n  }, \"Blog Posts\"), posts && posts.map(function (post) {\n    var postLocation = \"\".concat(location, \"/\").concat(post.slug);\n    return /*#__PURE__*/React.createElement(Card, {\n      key: post.id,\n      title: post.title,\n      location: postLocation,\n      content: post.content,\n      imageSrc: post.image.url,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 13\n      }\n    });\n  }));\n}\n\nexport default Posts;","map":{"version":3,"sources":["D:/Code/Projects/piano-teacher/frontend/src/pages/Blog/Posts.js"],"names":["React","useState","useEffect","useLocation","GET_POSTS","useLazyQuery","Card","Posts","increment","posts","setPosts","getPosts","data","scroll","setScroll","location","pathname","updateScroll","document","body","scrollHeight","window","screen","height","scrollY","addEventListener","variables","limit","length","map","post","postLocation","slug","id","title","content","image","url"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,SAASC,SAAT,QAA0B,eAA1B;AACA,SAASC,YAAT,QAA6B,gBAA7B;AACA,OAAOC,IAAP,MAAiB,uBAAjB;;AAEA,SAASC,KAAT,GAAiB;AAAA;;AACf,MAAMC,SAAS,GAAG,CAAlB;;AADe,kBAEWP,QAAQ,EAFnB;AAAA;AAAA,MAERQ,KAFQ;AAAA,MAEDC,QAFC;;AAAA,sBAGcL,YAAY,CAACD,SAAD,CAH1B;AAAA;AAAA,MAGRO,QAHQ;AAAA,MAGIC,IAHJ,qBAGIA,IAHJ;;AAAA,mBAIaX,QAAQ,CAAC,CAAD,CAJrB;AAAA;AAAA,MAIRY,MAJQ;AAAA,MAIAC,SAJA;;AAKf,MAAMC,QAAQ,GAAGZ,WAAW,GAAGa,QAA/B;;AAEA,WAASC,YAAT,GAAwB;AACtB,WAAOC,QAAQ,CAACC,IAAT,CAAcC,YAAd,IAA8BC,MAAM,CAACC,MAAP,CAAcC,MAAd,GAAuBF,MAAM,CAACG,OAA5D,CAAP;AACD;;AAEDtB,EAAAA,SAAS,CAAC,YAAM;AACdmB,IAAAA,MAAM,CAACI,gBAAP,CAAwB,QAAxB,EAAkC;AAAA,aAAMX,SAAS,CAACG,YAAY,EAAb,CAAf;AAAA,KAAlC;AACAN,IAAAA,QAAQ,CAAC;AAAEe,MAAAA,SAAS,EAAE;AAAEC,QAAAA,KAAK,EAAEnB;AAAT;AAAb,KAAD,CAAR;AACD,GAHQ,EAGN,EAHM,CAAT;AAKAN,EAAAA,SAAS,CAAC,YAAM;AACd,QAAI,CAACU,IAAD,IAASC,MAAM,GAAG,CAAtB,EAAyB;AACzBF,IAAAA,QAAQ,CAAC;AAAEe,MAAAA,SAAS,EAAE;AAAEC,QAAAA,KAAK,EAAEf,IAAI,CAACH,KAAL,CAAWmB,MAAX,GAAoBpB;AAA7B;AAAb,KAAD,CAAR;AACAM,IAAAA,SAAS,CAACG,YAAY,EAAb,CAAT;AACAP,IAAAA,QAAQ,CAACE,IAAI,CAACH,KAAN,CAAR;AACD,GALQ,EAKN,CAACG,IAAD,EAAOC,MAAP,CALM,CAAT;AAOA,sBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,EAEGJ,KAAK,IACJA,KAAK,CAACoB,GAAN,CAAU,UAAAC,IAAI,EAAI;AAChB,QAAMC,YAAY,aAAMhB,QAAN,cAAkBe,IAAI,CAACE,IAAvB,CAAlB;AACA,wBACE,oBAAC,IAAD;AACE,MAAA,GAAG,EAAEF,IAAI,CAACG,EADZ;AAEE,MAAA,KAAK,EAAEH,IAAI,CAACI,KAFd;AAGE,MAAA,QAAQ,EAAEH,YAHZ;AAIE,MAAA,OAAO,EAAED,IAAI,CAACK,OAJhB;AAKE,MAAA,QAAQ,EAAEL,IAAI,CAACM,KAAL,CAAWC,GALvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF;AASD,GAXD,CAHJ,CADF;AAkBD;;AAED,eAAe9B,KAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport { GET_POSTS } from \"../../apollo/\";\r\nimport { useLazyQuery } from \"@apollo/client\";\r\nimport Card from \"../../components/Card\";\r\n\r\nfunction Posts() {\r\n  const increment = 5;\r\n  const [posts, setPosts] = useState();\r\n  const [getPosts, { data }] = useLazyQuery(GET_POSTS);\r\n  const [scroll, setScroll] = useState(0);\r\n  const location = useLocation().pathname;\r\n\r\n  function updateScroll() {\r\n    return document.body.scrollHeight - (window.screen.height + window.scrollY);\r\n  }\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"scroll\", () => setScroll(updateScroll()));\r\n    getPosts({ variables: { limit: increment } });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!data || scroll > 0) return;\r\n    getPosts({ variables: { limit: data.posts.length + increment } });\r\n    setScroll(updateScroll());\r\n    setPosts(data.posts);\r\n  }, [data, scroll]);\r\n\r\n  return (\r\n    <section>\r\n      <section-title>Blog Posts</section-title>\r\n      {posts &&\r\n        posts.map(post => {\r\n          const postLocation = `${location}/${post.slug}`;\r\n          return (\r\n            <Card\r\n              key={post.id}\r\n              title={post.title}\r\n              location={postLocation}\r\n              content={post.content}\r\n              imageSrc={post.image.url}\r\n            />\r\n          );\r\n        })}\r\n    </section>\r\n  );\r\n}\r\n\r\nexport default Posts;\r\n"]},"metadata":{},"sourceType":"module"}